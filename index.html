<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./assets/css/normalize.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Martian+Mono:wght@100;200;300;400;500;600;700;800&family=Permanent+Marker&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css" />
    <link rel="stylesheet" href="./assets/css/style.css" />
    <title>GameBox</title>
  </head>

  <body onload="pageLoad()">
    <header class="navbar is-flex is-justify-content-space-between has-background-dark p-3">
      <div class="navbar-brand">
        <span class="has-text-weight-bold has-text-danger is-size-4">GameBox</span>
      </div>
      <button class="button is-light" onclick="toggleDarkMode()">Toggle Dark Mode</button>
    </header>

    <section class="navbar-menu">
      <div class="navbar-end">
        <div id="pagination"></div>
        <div id="suggestions"></div>
        <select id="genreFilter" class="select" onchange="filterByGenre(this.value)">
          <option value="action">Action</option>
          <option value="adventure">Adventure</option>
        </select>
        
        <form id="form" role="search" class="field is-grouped mb-0">
          <input id="query" name="q" class="input is-rounded" type="text" placeholder="Search Games..." list="games-datalist" />
          <datalist id="games-datalist"></datalist>
          <button id="SearchBtn" class="button is-danger">Search</button>
        </form>
      </div>
    </section>

    <div id="carousel-container" class="d-flex justify-content-center mt-2">
      <div id="screenshotCarousel">
        <img class="lazy" data-src="..\..\images\GameboxLogo.png" alt="Game Image" />
      </div>
    </div>

    <div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="4000">
      <div class="carousel-inner mt-3">
        <img class="lazy" data-src="path/to/image.jpg" alt="Game Image" />
      </div>
      <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>

    <!-- Modal -->
    <div id="gameDetailModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2 id="modalTitle"></h2>
        <p id="modalDescription"></p>
      </div>
    </div>

    <div id="alertModal" class="modalcontent">
      <span id="xbtn" class="has-background-danger" onclick="hideAlertModal()">&times;</span>
      <p id="alertMessage">This is an alert message.</p>
    </div>

    <main>
      <section class="columns">
        <section class="column is-one-quarter tile is-vertical">
          <article class="tile is-child notification has-background-warning" data-aos="flip-right">
            <p class="title">Wishlist Items</p>
            <p>Wishlist Count: <span id="wishlist-count">0</span></p>
            <div id="wishlist-id"></div>
          </article>
        </section>

        <section class="column is-half tile is-vertical">
          <article class="tile is-child notification is-danger" data-aos="fade-down-left">
            <p id="vgTitle" class="title"></p>
            <p id="releaseDate" class="subtitle"></p>
            <div class="content">
              <article class="tile is-child notification is-primary">
                <p class="title">Description:</p>
                <p id="vgDescription" class="subtitle"></p>
              </article>
            </div>
          </article>

          <article class="tile is-child notification is-info" data-aos="fade-up-right">
            <p class="title">Rating:</p>
            <p id="vgRating" class="subtitle"></p>
            <div id="ratingStars"></div>
          </article>

          <article class="tile is-child notification is-success" data-aos="fade-up-left">
            <p class="title">Platforms:</p>
            <p id="vgPlatforms" class="subtitle"></p>
          </article>

          <article class="tile notification has-background-grey-lighter" data-aos="fade-up">
            <div id="vgImages" class="content"></div>
          </article>

          <div id="loadingSpinner" class="is-flex is-justify-content-center" style="display:none;">
            <img src="path/to/spinner.gif" alt="Loading..." />
          </div>

          <article class="tile is-child notification is-primary is-flex is-justify-content-center" data-aos="zoom-out">
            <button id="saveBtn" class="button is-danger">Save To Wishlist</button>
          </article>

          <div id="relatedGames" class="notification has-background-info is-flex is-justify-content-center">
            <h1 class="title is-size-5 has-text-white">Related Games</h1>
          </div>

          <input id="searchInput" type="text" placeholder="Search Games..." class="input" oninput="filterGames()" />
          <ul id="gameList" class="notification has-background-grey"></ul>
        </section>

        <section class="column is-one-quarter tile is-vertical">
          <article class="tile is-child notification has-background-danger has-text-danger-light">
            <div id="chartContent" class="content chartBox" data-aos="flip-left" data-aos-duration="2000">
              <p class="title">Comparable Ratings</p>
              <p class="is-italic has-text-warning">** hover over chart to get specific rating **</p>
              <canvas id="ratingChart" height="150" width="175" class="notification has-background-grey-lighter"></canvas>
              <canvas id="popChart" height="150" width="175" class="notification has-background-grey-lighter"></canvas>
            </div>
          </article>
        </section>
      </section>

      <div id="ratingStars" class="is-flex is-justify-content-center mt-4">
        <!-- Rating stars will go here -->
      </div>
    </main>

    <!-- External Scripts (moved to bottom for performance) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="./assets/js/script.js"></script>

    <!-- Lazy Load Images -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const lazyImages = [].slice.call(document.querySelectorAll("img.lazy"));
        lazyImages.forEach((img) => {
          img.src = img.dataset.src;
        });
      });
    </script>

    <!-- Star Rating System -->
    <script>
      function generateStarRating(rating) {
        const starContainer = document.getElementById("ratingStars");
        starContainer.innerHTML = ''; // Clear previous stars
        const fullStar = '<span class="fa fa-star checked"></span>';
        const emptyStar = '<span class="fa fa-star"></span>';
        for (let i = 0; i < 5; i++) {
          starContainer.innerHTML += i < rating ? fullStar : emptyStar;
        }
      }

      // Example Usage: Call this when game data loads
      generateStarRating(4); // Pass in game rating dynamically
    </script>
  </body>
</html>
